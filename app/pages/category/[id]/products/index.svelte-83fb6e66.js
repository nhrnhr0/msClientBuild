import{a7 as d,S as y,i as C,s as E,e as w,t as h,c as x,a as F,g,d as f,b as p,f as m,E as k,h as P,l as _,M as b,_ as A}from"../../../../chunks/vendor-ab4be69b.js";import{S as T,u as l,g as G}from"../../../../chunks/cookies-d7879264.js";import{i as O}from"../../../../chunks/utils-6e4fb32a.js";let i={};function j(a,o,c,s=!1){let t={"Content-Type":"application/json","Content-Type":"application/json; charset=UTF-8"};o&&o.method=="POST"?(t["X-CSRFToken"]=G("csrftoken"),console.log("set scft token: ",t["X-CSRFToken"])):console.log("csrf token is unneed"),d(l).access&&(t.Authorization="Token "+d(l).access),console.log("headers_json: ",t);var n=new Headers(t);o=Object.assign({},{method:"GET",mode:"cors",credentials:"include",headers:n,redirect:"follow"},o);let e;try{e=c?c(a,o):fetch(a,o)}catch(r){console.error(r)}return e.then(r=>{if(r.status==401){console.log("data.status == 401");let u=d(l);if(u.isLogin=!1,u.access=null,l.set(u),!s)return j(a,o,c,!0)}return r.json()}).then(r=>(console.log(r),r))}function S(a,o,c){const s=a.slice();return s[1]=o[c],s}function v(a){let o,c,s,t,n=a[1].id+"";return{c(){o=w("a"),c=h("Product "),s=h(n),this.h()},l(e){o=x(e,"A",{href:!0});var r=F(o);c=g(r,"Product "),s=g(r,n),r.forEach(f),this.h()},h(){p(o,"href",t="./products/"+a[1].id+"/")},m(e,r){m(e,o,r),k(o,c),k(o,s)},p(e,r){1&r&&n!==(n=e[1].id+"")&&P(s,n),1&r&&t!==(t="./products/"+e[1].id+"/")&&p(o,"href",t)},d(e){e&&f(o)}}}function R(a){let o,c=a[0],s=[];for(let t=0;t<c.length;t+=1)s[t]=v(S(a,c,t));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();o=_()},l(t){for(let n=0;n<s.length;n+=1)s[n].l(t);o=_()},m(t,n){for(let e=0;e<s.length;e+=1)s[e].m(t,n);m(t,o,n)},p(t,[n]){if(1&n){let e;for(c=t[0],e=0;e<c.length;e+=1){const r=S(t,c,e);s[e]?s[e].p(r,n):(s[e]=v(r),s[e].c(),s[e].m(o.parentNode,o))}for(;e<s.length;e+=1)s[e].d(1);s.length=c.length}},i:b,o:b,d(t){A(s,t),t&&f(o)}}}async function L({page:a,fetch:o,session:c,contex:s}){if(console.log(a.params.id),O(a.params.id)){let t=await function(n,e){if(console.log("get_album_details: ",n),i[n])return console.log("return ",n," from cache"),i[n];{console.log("return ",n," from server"),console.log("fetch from: ",T+"/_get_album_images/"+n);let r=j(T+"/_get_album_images/"+n,{method:"GET"},e);return i[n]=r,i[n]}}(a.params.id,o);return console.log(t),{props:{products:t}}}}function X(a,o,c){let{products:s}=o;return a.$$set=t=>{"products"in t&&c(0,s=t.products)},[s]}class M extends y{constructor(o){super(),C(this,o,X,R,E,{products:0})}}export{M as default,L as load};

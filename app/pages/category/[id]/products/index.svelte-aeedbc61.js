import{a6 as d,S as y,i as C,s as E,e as w,t as h,c as x,a as F,g,d as f,b as p,f as m,E as k,h as P,l as _,M as T,_ as A}from"../../../../chunks/vendor-9f1a2415.js";import{S as j,u as l,g as G}from"../../../../chunks/cookies-a4d03e43.js";import{i as O}from"../../../../chunks/utils-6e4fb32a.js";let i={};function b(c,o,a,s=!1){let t={"Content-Type":"application/json","Content-Type":"application/json; charset=UTF-8"};o&&o.method=="POST"?(t["X-CSRFToken"]=G("csrftoken"),console.log("set scft token: ",t["X-CSRFToken"])):console.log("csrf token is unneed"),d(l).access&&(t.Authorization="Token "+d(l).access),console.log("headers_json: ",t);var n=new Headers(t);o=Object.assign({},{method:"GET",mode:"cors",credentials:"include",headers:n,redirect:"follow"},o);let e;try{e=a?a(c,o):fetch(c,o)}catch(r){console.error(r)}return e.then(r=>{if(r.status==401){console.log("data.status == 401");let u=d(l);if(u.isLogin=!1,u.access=null,l.set(u),!s)return b(c,o,a,!0)}return r.json()}).then(r=>(console.log(r),r))}function S(c,o,a){const s=c.slice();return s[1]=o[a],s}function v(c){let o,a,s,t,n=c[1].id+"";return{c(){o=w("a"),a=h("Product "),s=h(n),this.h()},l(e){o=x(e,"A",{href:!0});var r=F(o);a=g(r,"Product "),s=g(r,n),r.forEach(f),this.h()},h(){p(o,"href",t="./products/"+c[1].id+"/")},m(e,r){m(e,o,r),k(o,a),k(o,s)},p(e,r){1&r&&n!==(n=e[1].id+"")&&P(s,n),1&r&&t!==(t="./products/"+e[1].id+"/")&&p(o,"href",t)},d(e){e&&f(o)}}}function R(c){let o,a=c[0],s=[];for(let t=0;t<a.length;t+=1)s[t]=v(S(c,a,t));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();o=_()},l(t){for(let n=0;n<s.length;n+=1)s[n].l(t);o=_()},m(t,n){for(let e=0;e<s.length;e+=1)s[e].m(t,n);m(t,o,n)},p(t,[n]){if(1&n){let e;for(a=t[0],e=0;e<a.length;e+=1){const r=S(t,a,e);s[e]?s[e].p(r,n):(s[e]=v(r),s[e].c(),s[e].m(o.parentNode,o))}for(;e<s.length;e+=1)s[e].d(1);s.length=a.length}},i:T,o:T,d(t){A(s,t),t&&f(o)}}}async function L({page:c,fetch:o,session:a,contex:s}){if(console.log(c.params.id),O(c.params.id)){let t=await function(n,e){if(console.log("get_album_details: ",n),i[n])return console.log("return ",n," from cache"),i[n];{console.log("return ",n," from server"),console.log("fetch from: ",j+"/_get_album_images/"+n);let r=b(j+"/_get_album_images/"+n,{method:"GET"},e);return i[n]=r,i[n]}}(c.params.id,o);return console.log(t),{props:{products:t}}}}function X(c,o,a){let{products:s}=o;return c.$$set=t=>{"products"in t&&a(0,s=t.products)},[s]}class M extends y{constructor(o){super(),C(this,o,X,R,E,{products:0})}}export{M as default,L as load};
